<?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns:cl="http://schemas.microsoft.com/sqlserver/reporting/2010/01/componentdefinition" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource1">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString>Data Source=10.20.10.107;Initial Catalog=HOANMY_SAIGON_HIS;Connect Timeout=30</ConnectString>
        <Prompt>Specify a user name and password for data source DataSource1:</Prompt>
      </ConnectionProperties>
      <rd:SecurityType>DataBase</rd:SecurityType>
      <rd:DataSourceID>1a4d28ad-c7e9-4b11-843c-f96f2aca9c1f</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="DataSet1">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@MABENHVIEN">
            <Value>=Parameters!MABENHVIEN.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@DVYEUCAU_ID">
            <Value>=Parameters!DVYEUCAU_ID.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandType>StoredProcedure</CommandType>
        <CommandText>RIS01P00101_RISID</CommandText>
      </Query>
      <Fields>
        <Field Name="MARIS">
          <DataField>MARIS</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="MAYTE">
          <DataField>MAYTE</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="TENBENHNHAN">
          <DataField>TENBENHNHAN</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="NAMSINH">
          <DataField>NAMSINH</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="TENBENHHANDOITUONG">
          <DataField>TENBENHHANDOITUONG</DataField>
          <rd:TypeName>System.Int16</rd:TypeName>
        </Field>
        <Field Name="GIOITINH">
          <DataField>GIOITINH</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="TENPHONGBAN">
          <DataField>TENPHONGBAN</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="TENDICHVU">
          <DataField>TENDICHVU</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="NGAYYEUCAU">
          <DataField>NGAYYEUCAU</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="NOICHIDINH">
          <DataField>NOICHIDINH</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="NGAYCHUP">
          <DataField>NGAYCHUP</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="TENDOITUONG">
          <DataField>TENDOITUONG</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="SOPHIMSUDUNG">
          <DataField>SOPHIMSUDUNG</DataField>
          <rd:UserDefined>true</rd:UserDefined>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <ReportSections>
    <ReportSection>
      <Body>
        <ReportItems>
          <Rectangle Name="Rectangle1">
            <ReportItems>
              <Textbox Name="Textbox7">
                <CanGrow>true</CanGrow>
                <KeepTogether>true</KeepTogether>
                <Paragraphs>
                  <Paragraph>
                    <TextRuns>
                      <TextRun>
                        <Value>PID:</Value>
                        <Style>
                          <FontFamily>Times New Roman</FontFamily>
                          <FontWeight>Bold</FontWeight>
                        </Style>
                      </TextRun>
                      <TextRun>
                        <Value xml:space="preserve"> </Value>
                        <Style>
                          <FontFamily>Times New Roman</FontFamily>
                        </Style>
                      </TextRun>
                      <TextRun>
                        <Value>=Fields!MAYTE.Value</Value>
                        <Style>
                          <FontFamily>Times New Roman</FontFamily>
                          <FontWeight>Bold</FontWeight>
                        </Style>
                      </TextRun>
                    </TextRuns>
                    <Style />
                  </Paragraph>
                </Paragraphs>
                <rd:DefaultName>Textbox2</rd:DefaultName>
                <Top>0.125in</Top>
                <Left>1.87837in</Left>
                <Height>0.18452in</Height>
                <Width>1.47849in</Width>
                <Style>
                  <Border>
                    <Style>None</Style>
                  </Border>
                  <VerticalAlign>Middle</VerticalAlign>
                  <PaddingLeft>2pt</PaddingLeft>
                  <PaddingRight>2pt</PaddingRight>
                  <PaddingTop>2pt</PaddingTop>
                  <PaddingBottom>2pt</PaddingBottom>
                </Style>
              </Textbox>
              <Textbox Name="Textbox8">
                <CanGrow>true</CanGrow>
                <KeepTogether>true</KeepTogether>
                <Paragraphs>
                  <Paragraph>
                    <TextRuns>
                      <TextRun>
                        <Value>=Fields!TENBENHHANDOITUONG.Value</Value>
                        <Style>
                          <FontFamily>Times New Roman</FontFamily>
                          <FontWeight>Bold</FontWeight>
                        </Style>
                      </TextRun>
                      <TextRun>
                        <Value xml:space="preserve"> </Value>
                        <Style>
                          <FontFamily>Times New Roman</FontFamily>
                          <FontWeight>Bold</FontWeight>
                        </Style>
                      </TextRun>
                      <TextRun>
                        <Value>(</Value>
                        <Style>
                          <FontFamily>Times New Roman</FontFamily>
                          <FontWeight>Normal</FontWeight>
                        </Style>
                      </TextRun>
                      <TextRun>
                        <Value>=Fields!GIOITINH.Value</Value>
                        <Style>
                          <FontFamily>Times New Roman</FontFamily>
                          <FontWeight>Normal</FontWeight>
                        </Style>
                      </TextRun>
                      <TextRun>
                        <Value>)</Value>
                        <Style>
                          <FontFamily>Times New Roman</FontFamily>
                          <FontWeight>Normal</FontWeight>
                        </Style>
                      </TextRun>
                    </TextRuns>
                    <Style />
                  </Paragraph>
                </Paragraphs>
                <rd:DefaultName>Textbox2</rd:DefaultName>
                <Top>0.35264in</Top>
                <Left>0.01435in</Left>
                <Height>0.15874in</Height>
                <Width>3.34251in</Width>
                <ZIndex>1</ZIndex>
                <Style>
                  <Border>
                    <Style>None</Style>
                  </Border>
                  <VerticalAlign>Middle</VerticalAlign>
                  <PaddingLeft>2pt</PaddingLeft>
                  <PaddingRight>2pt</PaddingRight>
                  <PaddingTop>2pt</PaddingTop>
                  <PaddingBottom>2pt</PaddingBottom>
                </Style>
              </Textbox>
              <Textbox Name="Textbox11">
                <CanGrow>true</CanGrow>
                <KeepTogether>true</KeepTogether>
                <Paragraphs>
                  <Paragraph>
                    <TextRuns>
                      <TextRun>
                        <Value>=Fields!TENDICHVU.Value</Value>
                        <Style>
                          <FontFamily>Times New Roman</FontFamily>
                          <FontSize>8pt</FontSize>
                          <FontWeight>Bold</FontWeight>
                        </Style>
                      </TextRun>
                    </TextRuns>
                    <Style />
                  </Paragraph>
                </Paragraphs>
                <rd:DefaultName>Textbox2</rd:DefaultName>
                <Top>0.68115in</Top>
                <Left>0.02083in</Left>
                <Height>0.18452in</Height>
                <Width>3.33603in</Width>
                <ZIndex>2</ZIndex>
                <Style>
                  <Border>
                    <Style>None</Style>
                  </Border>
                  <VerticalAlign>Middle</VerticalAlign>
                  <PaddingLeft>2pt</PaddingLeft>
                  <PaddingRight>2pt</PaddingRight>
                  <PaddingTop>2pt</PaddingTop>
                  <PaddingBottom>2pt</PaddingBottom>
                </Style>
              </Textbox>
              <Textbox Name="Textbox12">
                <CanGrow>true</CanGrow>
                <KeepTogether>true</KeepTogether>
                <Paragraphs>
                  <Paragraph>
                    <TextRuns>
                      <TextRun>
                        <Value>=Fields!NOICHIDINH.Value</Value>
                        <Style>
                          <FontFamily>Times New Roman</FontFamily>
                          <FontWeight>Bold</FontWeight>
                        </Style>
                      </TextRun>
                    </TextRuns>
                    <Style />
                  </Paragraph>
                </Paragraphs>
                <rd:DefaultName>Textbox2</rd:DefaultName>
                <Top>0.51138in</Top>
                <Left>0.02083in</Left>
                <Height>0.15588in</Height>
                <Width>1.62153in</Width>
                <ZIndex>3</ZIndex>
                <Style>
                  <Border>
                    <Style>None</Style>
                  </Border>
                  <VerticalAlign>Middle</VerticalAlign>
                  <PaddingLeft>2pt</PaddingLeft>
                  <PaddingRight>2pt</PaddingRight>
                  <PaddingTop>2pt</PaddingTop>
                  <PaddingBottom>2pt</PaddingBottom>
                </Style>
              </Textbox>
              <Textbox Name="NGAYYEUCAU">
                <CanGrow>true</CanGrow>
                <KeepTogether>true</KeepTogether>
                <Paragraphs>
                  <Paragraph>
                    <TextRuns>
                      <TextRun>
                        <Value>Ngày chụp: </Value>
                        <Style>
                          <FontFamily>Times New Roman</FontFamily>
                        </Style>
                      </TextRun>
                      <TextRun>
                        <Value>=Fields!NGAYCHUP.Value</Value>
                        <Style>
                          <FontFamily>Times New Roman</FontFamily>
                          <Format>dd/MM/yyyy</Format>
                        </Style>
                      </TextRun>
                    </TextRuns>
                    <Style>
                      <TextAlign>Left</TextAlign>
                    </Style>
                  </Paragraph>
                </Paragraphs>
                <rd:DefaultName>NGAYYEUCAU</rd:DefaultName>
                <Top>0.51138in</Top>
                <Left>1.64236in</Left>
                <Height>0.15588in</Height>
                <Width>1.7145in</Width>
                <ZIndex>4</ZIndex>
                <Style>
                  <Border>
                    <Style>None</Style>
                  </Border>
                  <PaddingLeft>2pt</PaddingLeft>
                  <PaddingRight>2pt</PaddingRight>
                  <PaddingTop>2pt</PaddingTop>
                  <PaddingBottom>2pt</PaddingBottom>
                </Style>
              </Textbox>
              <Image Name="Image1">
                <Source>Database</Source>
                <Value>=CodeGen128.Code128Rendering.MakeBarcodeImage(Fields!MAYTE.Value, 2500, 500, true, true)</Value>
                <MIMEType>image/png</MIMEType>
                <Sizing>FitProportional</Sizing>
                <Left>0.05292cm</Left>
                <Height>0.33876in</Height>
                <Width>1.84365in</Width>
                <ZIndex>5</ZIndex>
                <Style>
                  <Border>
                    <Style>None</Style>
                  </Border>
                  <PaddingLeft>3pt</PaddingLeft>
                  <PaddingBottom>2pt</PaddingBottom>
                </Style>
              </Image>
              <Textbox Name="Textbox13">
                <CanGrow>true</CanGrow>
                <KeepTogether>true</KeepTogether>
                <Paragraphs>
                  <Paragraph>
                    <TextRuns>
                      <TextRun>
                        <Value>Số phim đã nhận: </Value>
                        <Style>
                          <FontFamily>Times New Roman</FontFamily>
                        </Style>
                      </TextRun>
                      <TextRun>
                        <Value>=Fields!SOPHIMSUDUNG.Value</Value>
                        <Style>
                          <FontFamily>Times New Roman</FontFamily>
                        </Style>
                      </TextRun>
                    </TextRuns>
                    <Style />
                  </Paragraph>
                </Paragraphs>
                <rd:DefaultName>Textbox2</rd:DefaultName>
                <Top>0.89345in</Top>
                <Left>0.02083in</Left>
                <Height>0.18452in</Height>
                <Width>3.33603in</Width>
                <ZIndex>6</ZIndex>
                <Style>
                  <Border>
                    <Style>None</Style>
                  </Border>
                  <VerticalAlign>Middle</VerticalAlign>
                  <PaddingLeft>2pt</PaddingLeft>
                  <PaddingRight>2pt</PaddingRight>
                  <PaddingTop>2pt</PaddingTop>
                  <PaddingBottom>2pt</PaddingBottom>
                </Style>
              </Textbox>
            </ReportItems>
            <KeepTogether>true</KeepTogether>
            <Left>0.25211cm</Left>
            <Height>1.13353in</Height>
            <Width>3.35687in</Width>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
            </Style>
          </Rectangle>
        </ReportItems>
        <Height>3.17902cm</Height>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
        </Style>
      </Body>
      <Width>8.77856cm</Width>
      <Page>
        <PageHeight>5cm</PageHeight>
        <PageWidth>9cm</PageWidth>
        <LeftMargin>0.1cm</LeftMargin>
        <RightMargin>0cm</RightMargin>
        <TopMargin>0.2cm</TopMargin>
        <BottomMargin>0cm</BottomMargin>
        <ColumnSpacing>1.27cm</ColumnSpacing>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <ReportParameters>
    <ReportParameter Name="MABENHVIEN">
      <DataType>String</DataType>
      <Prompt>MABENHVIEN</Prompt>
    </ReportParameter>
    <ReportParameter Name="TENBENHVIEN">
      <DataType>String</DataType>
      <Nullable>true</Nullable>
      <AllowBlank>true</AllowBlank>
      <Prompt>TENBENHVIEN</Prompt>
    </ReportParameter>
    <ReportParameter Name="DVYEUCAU_ID">
      <DataType>Integer</DataType>
      <Nullable>true</Nullable>
      <Prompt>DVYEUCAU ID</Prompt>
    </ReportParameter>
    <ReportParameter Name="URL_BARCODE">
      <DataType>String</DataType>
      <Nullable>true</Nullable>
      <AllowBlank>true</AllowBlank>
      <Prompt>ReportParameter1</Prompt>
    </ReportParameter>
  </ReportParameters>
  <Code> Public Function changeCurrencyToWords(numb As Double) As String       
        Dim num As String = numb.ToString()
        numb = num.TrimStart("0")
        Return changeToWords(num, True)
    End Function
    Private Function changeToWords(numb As String, isCurrency As Boolean) As String
        Dim val As String = "", wholeNo As String = numb, points As String = "", andStr As String = "", pointStr As String = ""
        Dim endStr As String = If((isCurrency), ("đồng chẵn"), (""))
        Try
            Dim decimalPlace As Integer = numb.IndexOf(".")
            If decimalPlace &gt; 0 Then
                wholeNo = numb.Substring(0, decimalPlace)
                points = numb.Substring(decimalPlace + 1)
                If Convert.ToInt32(points) &gt; 0 Then
                    andStr = If((isCurrency), ("and"), ("point"))
                    ' just to separate whole numbers from points/cents
                    endStr = If((isCurrency), ("Cents " + endStr), (""))
                    pointStr = translateCents(points)
                End If
            End If
            val = [String].Format("{0} {1}{2} {3}", translateWholeNumber(wholeNo).Trim(), andStr, pointStr, endStr)
        Catch


        End Try
        Return val
    End Function
    Private Function translateWholeNumber(number As String) As String
        Dim word As String = ""

        Try
            Dim beginsZero As Boolean = False
            'tests for 0XX
            Dim isDone As Boolean = False
            'test if already translated
            Dim dblAmt As Double = (Convert.ToDouble(number))
            'if ((dblAmt &gt; 0) &amp;&amp; number.StartsWith("0"))
            If dblAmt &gt; 0 Then
                'test for zero or digit zero in a nuemric
                beginsZero = number.StartsWith("0")
                Dim numDigits As Integer = number.Length
                Dim pos As Integer = 0
                'store digit grouping
                Dim place As [String] = ""
                'digit grouping name:hundres,thousand,etc...
                Select Case numDigits
                    Case 1
                        'ones' range
                        word = ones(number)
                        isDone = True

                        Exit Select
                    Case 2
                        'tens' range
                        word = tens(number)
                        If beginsZero Then
                            word = " lẻ " + word.Trim()
                            beginsZero = False
                        End If
                        isDone = True

                        Exit Select
                    Case 3
                        'hundreds' range
                        pos = (numDigits Mod 3) + 1
                        place = " trăm "
                        If beginsZero Then
                            place = "không " + place.Trim()
                            beginsZero = False
                        End If

                        Exit Select
                'thousands' range
                    Case 4, 5, 6
                        pos = (numDigits Mod 4) + 1
                        place = " nghìn "

                        Exit Select
                'millions' range
                    Case 7, 8, 9
                        pos = (numDigits Mod 7) + 1
                        place = " triệu "

                        Exit Select
                    Case 10
                        'Billions's range
                        pos = (numDigits Mod 10) + 1
                        place = " tỉ "

                        Exit Select
                    Case Else
                        'add extra case options for anything above Billion...
                        isDone = True
                        Exit Select
                End Select
                If Not isDone Then
                    'if transalation is not done, continue...(Recursion comes in now!!)                        
                    'check for trailing zeros
                    'if (beginsZero) word = " and " + word.Trim();
                    'if (beginsZero)
                    '{
                    '    word = "không" + word.Trim();
                    '    beginsZero = false;
                    '}
                    word = translateWholeNumber(number.Substring(0, pos)) + " " + place + " "+ translateWholeNumber(number.Substring(pos))
                End If
                'ignore digit grouping names
                If word.Trim().Equals(place.Trim()) Then
                    word = ""
                End If
            End If
        Catch


        End Try

        Return word.Trim()
    End Function
    Private Function tens(digit As String) As String
        Dim digt As Integer = Convert.ToInt32(digit)
        Dim name As String = Nothing
        Select Case digt
            Case 10
                name = "mười"
                Exit Select
            Case 11
                name = "mười một"
                Exit Select
            Case 12
                name = "mười hai"
                Exit Select
            Case 13
                name = "mười ba"
                Exit Select
            Case 14
                name = "mười bốn"
                Exit Select
            Case 15
                name = "mười lăm"
                Exit Select
            Case 16
                name = "mười sáu"
                Exit Select
            Case 17
                name = "mười bảy"
                Exit Select
            Case 18
                name = "mười tám"
                Exit Select
            Case 19
                name = "mười chín"
                Exit Select
            Case 20
                name = "hai mươi"
                Exit Select
            Case 30
                name = "ba mươi"
                Exit Select
            Case 40
                name = "bốn mươi"
                Exit Select
            Case 50
                name = "năm mươi"
                Exit Select
            Case 60
                name = "sáu mươi"
                Exit Select
            Case 70
                name = "bảy mươi"
                Exit Select
            Case 80
                name = "tám mươi"
                Exit Select
            Case 90
                name = "chín mươi"
                Exit Select
            Case Else
                If digt &gt; 0 Then
                    name = tens(digit.Substring(0, 1) + "0") + " " + ones(digit.Substring(1))
                End If
                Exit Select
        End Select
        Return name
    End Function
    Private Function ones(digit As String) As String
        Dim digt As Integer = Convert.ToInt32(digit)
        Dim name As String = ""
        Select Case digt
            Case 1
                name = "một"
                Exit Select
            Case 2
                name = "hai"
                Exit Select
            Case 3
                name = "ba"
                Exit Select
            Case 4
                name = "bốn"
                Exit Select
            Case 5
                name = "năm"
                Exit Select
            Case 6
                name = "sáu"
                Exit Select
            Case 7
                name = "bảy"
                Exit Select
            Case 8
                name = "tám"
                Exit Select
            Case 9
                name = "chín"
                Exit Select
        End Select
        Return name
    End Function
    Private Function translateCents(cents As String) As String
        Dim cts As String = "", digit As String = "", engOne As String = ""
        For i As Integer = 0 To cents.Length - 1
            digit = cents(i).ToString()
            If digit.Equals("0") Then
                engOne = "Zero"
            Else
                engOne = ones(digit)
            End If
            cts += " " + engOne
        Next
        Return cts
    End Function



</Code>
  <CodeModules>
    <CodeModule>CodeGen128, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null</CodeModule>
  </CodeModules>
  <rd:ReportUnitType>Cm</rd:ReportUnitType>
  <rd:ReportID>945e6ece-ed91-4308-8ea4-3da9d4ededa7</rd:ReportID>
</Report>